<?xml version="1.0"?>
<launch>

    <!-- <rosparam file="$(find smobex_bringup)/params/default_params.yaml" command="load"/> -->

    <group ns="/pcl_filters">
        <rosparam file="$(find smobex_bringup)/params/pcl_params.yaml" command="load" />

        <!-- PCL Manager -->
        <node pkg="nodelet" type="nodelet" name="box_filter_pcl_manager" args="manager" output="screen"/>

        <!-- Run a passthrough filter to delimit in x direction -->
        <node pkg="nodelet" type="nodelet" name="psx" args="load pcl/PassThrough box_filter_pcl_manager" output="screen">
            <remap from="~input" to="/camera/depth_registered/points" />
            <rosparam>
                filter_field_name: x
                filter_limit_min: -5
                filter_limit_max: 5 
                input_frame: base_link
            </rosparam>
        </node>

        <!-- Run a passthrough filter to delimit in y direction -->
        <node pkg="nodelet" type="nodelet" name="psy" args="load pcl/PassThrough box_filter_pcl_manager" output="screen">
            <remap from="~input" to="psx/output" />
            <rosparam>
                filter_field_name: y
                filter_limit_min: -5
                filter_limit_max: 5 
                input_frame: base_link
            </rosparam>
        </node>

        <!-- Run a passthrough filter to delimit in z direction -->
        <node pkg="nodelet" type="nodelet" name="psz" args="load pcl/PassThrough box_filter_pcl_manager" output="screen">
            <remap from="~input" to="psy/output" />
            <remap from="~output" to="pcl_filtered"/>
            <rosparam>
                filter_field_name: z
                filter_limit_min: -5
                filter_limit_max: 5 
                input_frame: base_link
            </rosparam>
        </node>
    </group>


    <node pkg="smobex_bringup" type="show_volume" name="show_volume" output="screen">

        <param name="~fixed_frame" value="/base_link"/>
        <!-- <remap from="~max_x" to="/pcl_filters/psx/filter_limit_max"/>
        <remap from="~min_x" to="/pcl_filters/psx/filter_limit_min"/>
        <remap from="~max_y" to="/pcl_filters/psy/filter_limit_max"/>
        <remap from="~min_y" to="/pcl_filters/psy/filter_limit_min"/>
        <remap from="~max_z" to="/pcl_filters/psz/filter_limit_max"/>
        <remap from="~min_z" to="/pcl_filters/psz/filter_limit_min"/> -->
        <param name="~x_min" value="-5"/>
        <param name="~y_min" value="-5"/>
        <param name="~z_min" value="-5"/>

        <param name="~x_max" value="5"/>
        <param name="~y_max" value="5"/>
        <param name="~z_max" value="5"/>

    </node>

</launch>