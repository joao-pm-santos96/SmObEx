<?xml version="1.0"?>
<launch>

    <!-- Options -->
    <arg name="config" default="false" doc="Enter configurations mode"/>
    <arg name="online" default="true"/>
    <arg name="octo_resolution" default="0.01"/>
    <arg name="robot_ip" default="192.168.0.230"/>
    <arg name="filtered_record" default="true" doc="If in capture mode, the point cloud in filteres or not"/>

    <!-- Modes -->
    <arg name="calibration" default="false"/>
    <arg name="capture" default="false"/>
    <arg name="define_vol" default="false"/>

    <!-- OpenNI2 -->
    <include file="$(find openni2_launch)/launch/openni2.launch">
        <arg name="publish_tf" value="false"/>
    </include>

    <!-- Autonomus mode -->
    <group unless="$(arg config)">

        <include file="$(find smobex_bringup)/launch/auto_mode.launch">
            <arg name="robot_ip" value="$(arg robot_ip)" />
            <arg name="online" value="$(arg online)"/>
            <arg name="octo_resolution" default="$(arg octo_resolution)"/>
        </include>

        <node pkg="smobex_explorer" type="pose_generator" name="pose_generator" output="screen">

            <param name="~n_poses" value="200"/>
            <param name="~scale" value="3"/>

            <remap from="~x_max" to="/pcl_filters/psx/filter_limit_max"/>
            <remap from="~x_min" to="/pcl_filters/psx/filter_limit_min"/>

            <remap from="~y_max" to="/pcl_filters/psy/filter_limit_max"/>
            <remap from="~y_min" to="/pcl_filters/psy/filter_limit_min"/>

            <remap from="~z_max" to="/pcl_filters/psz/filter_limit_max"/>
            <remap from="~z_min" to="/pcl_filters/psz/filter_limit_min"/>
            
        </node>

    </group>

    <!-- Configs mode -->
    <group if="$(arg config)">

        <!-- Calibration -->
        <include if="$(arg calibration)" file="$(find smobex_bringup)/launch/calib_mode.launch">
            <arg name="robot_ip" value="$(arg robot_ip)"/>
        </include>

        <!-- Define Volume -->
        <include if="$(arg define_vol)" file="$(find smobex_bringup)/launch/defineVol_mode.launch">
            <arg name="robot_ip" value="$(arg robot_ip)" />
            <arg name="online" value="$(arg online)"/>
        </include>

        <!-- Capture -->
        <include if="$(arg capture)" file="$(find smobex_bringup)/launch/capture_mode.launch">
            <arg name="robot_ip" value="$(arg robot_ip)" />
            <arg name="online" value="$(arg online)"/>
            <arg name="octo_resolution" value="$(arg octo_resolution)"/>
            <arg name="filtered" value="$(arg filtered_record)"/>
        </include>
    </group>

</launch>